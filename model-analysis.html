<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CIS â€” Model Analysis</title>

    <!-- Logo Title -->
    <link rel="icon" href="images/cis_logo_t.png" type="image/x-icon/">
    
    <!-- CSS Links -->
    <link rel="stylesheet" href="styles/general.css">
    <link rel="stylesheet" href="styles/header.css">
    <link rel="stylesheet" href="styles/homepage.css">
    <link rel="stylesheet" href="styles/figure-container.css">
    <link rel="stylesheet" href="styles/model.css">
    <link rel="stylesheet" href="styles/crustacean-species.css">
    <link rel="stylesheet" href="styles/footer.css">
    
</head>
<body>

    <!-- Header -->
    <div class="header">
        <div>
            <img class="logo-img" src="images/cis_logo_name.png">
        </div>
        <div>
            <a href="landing-page.html">
                <button class="right-btn">Home</button>
            </a>
        </div>
    </div>

    <!-- Homepage -->
    <div class="homepage">
        <img class="top-homepage-img" src="images/background_img5.jpg">
        <div class="bottom-right">
            <strong class="bottom-right-str">Model Analysis</strong><br>
            <span class="bottom-right-spn">Build, train, and evaluate a CNN model to classify crustaceans using TensorFlow, an open-source<br>
                  platform for machine learning that provides computer vision (CV) and image classification tools.</span>
        </div>
    </div>

    <!-- Model Training Process -->
    <div class="model-trng-cntr">
        <div class="figure-title">Model Training Process</div>
        <hr class="hr-tlt">
        <div>
            <div class="name name-left">Data Preparation:</div>
            <div>
                <img class="model-trng-img" src="figures/model/steps/1_data_preparation.png" alt="Process 1" 
                onclick="openPopup('mdl-1', 'figures/model/steps/1_data_preparation.png', 'For data preparation, the model required crustaceans images related to the target species, which are loaded under crab-images-dataset. The datasets are then splits into train, valid, and test batches for preprocessing. It found 3833 images on training set, 1157 on validation set, and 1369 on testing set.')">
            </div>
        </div>

        <hr>

        <div>
            <div class="name name-left">Build the Model:</div>
            <div>
                <img class="model-trng-img" src="figures/model/steps/2_build_model.png" alt="Process 2" 
                onclick="openPopup('mdl-2', 'figures/model/steps/2_build_model.png', 'The CNN architecture is defined using Sequential(), a convoluted model which include stacking convolutional 2D, pooling, and fully connected layers. Moreover, it is built with normalization and dropouts for an efficient model training.')">
            </div>
        </div>

        <hr>

        <div>
            <div class="name name-left">Compile the Model:</div>
            <div>
                <img class="model-trng-img" src="figures/model/steps/3_compile_model.png" alt="Process 3" 
                onclick="openPopup('mdl-3', 'figures/model/steps/3_compile_model.png', '	After defining a CNN architecture, the model is compiled by configuring optimizer using Adam function with a learning rate of 0.0001, a categorcal crossentropy loss function, and accuracy evaluation metrics.')">
            </div>
        </div>

        <hr>

        <div>
            <div class="name name-left">Train the Model:</div>
            <div>
                <img class="model-trng-img" src="figures/model/steps/4_train_model.png" alt="Process 4" 
                onclick="openPopup('mdl-4', 'figures/model/steps/4_train_model.png', 'To train the model, it uses fit() function on the model that adjust weights using backpropagation and evaluates performance based on validation data. The epochs had an early stop on iteration 9 concluding that the best weight for the model can only have an accuracy of 0.6580 with loss 0.8442 - validation accuracy of 0.5013 with validation loss 1.4180.')">
            </div>
        </div>

        <hr>

        <div>
            <div class="name name-left">Model Prediction:</div>
            <div>
                <img class="model-trng-img" src="figures/model/steps/5_evaluate_model.png" alt="Process 5" 
                onclick="openPopup('mdl-5', 'figures/model/steps/5_evaluate_model.png', 'The model is used to predict to check if the trained model performed well on unseen data. It has a test accuracy 0.43 and test loss of 1.42.')">
            </div>
        </div>

        <hr>
    </div>

    <!-- Model Evaluation -->
    
    <div class="figure-title">Model Evaluation</div>

    <div class="model-eval-cntr">
        <div class="model-eval-item">
            <img class="model-eval-img" src="figures/model/model_cm.png" alt="LBP-Histogram Between Crab Species" 
            onclick="openPopup('mdl-eval', 'figures/model/model_cm.png', 'This matrix shows that fiddler_crab, with 195 correct predictions, has the highest accuracy among all species, although 99 instances were misclassified as hermit_crab, suggesting some similarity between their features. King_crab also performs well, with 184 correct predictions.')">
            <div class="model-eval-title">Confusion Matrix</div>
        </div>
    </div>

    <div class="model-eval-cntr">
        <div class="model-eval-item">
            <img class="model-eval-img" src="figures/model/model_classification_report.png" alt="LBP Texture-Feature Correlation" 
            onclick="openPopup('mdl-eval-1', 'figures/model/model_classification_report.png', 'The classification report indicates that the machine learning model has an overall accuracy of 44%, with varying performance across different crab species. The King Crab class performs the best, achieving the highest precision (0.72) and a strong F1-score (0.57).')">
            <div class="model-eval-title">Model Classification Report</div>
        </div>
    </div>

    <div class="cntr-space"></div>

    <!-- Popup Modal -->
    <div class="popup-mdl" id="popup-mdl">
        <div class="popup-content-mdl">
            <span class="close-btn" onclick="closePopup('mdl')">&times;</span>
            <img id="popup-img-mdl" src="" alt="Popup Image">
            <p id="popup-desc-mdl"></p>
        </div>
    </div>

    <div class="popup-mdl-1" id="popup-mdl-1">
        <div class="popup-content-mdl-1">
            <span class="close-btn" onclick="closePopup('mdl-1')">&times;</span>
            <img id="popup-img-mdl-1" src="" alt="Popup Image">
            <p id="popup-desc-mdl-1"></p>
        </div>
    </div>

    <div class="popup-mdl-2" id="popup-mdl-2">
        <div class="popup-content-mdl-2">
            <span class="close-btn" onclick="closePopup('mdl-2')">&times;</span>
            <img id="popup-img-mdl-2" src="" alt="Popup Image">
            <p id="popup-desc-mdl-2"></p>
        </div>
    </div>

    <div class="popup-mdl-3" id="popup-mdl-3">
        <div class="popup-content-mdl-3">
            <span class="close-btn" onclick="closePopup('mdl-3')">&times;</span>
            <img id="popup-img-mdl-3" src="" alt="Popup Image">
            <p id="popup-desc-mdl-3"></p>
        </div>
    </div>

    <div class="popup-mdl-4" id="popup-mdl-4">
        <div class="popup-content-mdl-4">
            <span class="close-btn" onclick="closePopup('mdl-4')">&times;</span>
            <img id="popup-img-mdl-4" src="" alt="Popup Image">
            <p id="popup-desc-mdl-4"></p>
        </div>
    </div>

    <div class="popup-mdl-5" id="popup-mdl-5">
        <div class="popup-content-mdl-5">
            <span class="close-btn" onclick="closePopup('mdl-5')">&times;</span>
            <img id="popup-img-mdl-5" src="" alt="Popup Image">
            <p id="popup-desc-mdl-5"></p>
        </div>
    </div>

    <div class="popup-mdl-eval" id="popup-mdl-eval">
        <div class="popup-content-mdl-eval">
            <span class="close-btn" onclick="closePopup('mdl-eval')">&times;</span>
            <img id="popup-img-mdl-eval" src="" alt="Popup Image">
            <p id="popup-desc-mdl-eval"></p>
        </div>
    </div>

    <div class="popup-mdl-eval-1" id="popup-mdl-eval-1">
        <div class="popup-content-mdl-eval-1">
            <span class="close-btn" onclick="closePopup('mdl-eval-1')">&times;</span>
            <img id="popup-img-mdl-eval-1" src="" alt="Popup Image">
            <p id="popup-desc-mdl-eval-1"></p>
        </div>
    </div>

    <!-- Crustacean Species -->
    <div class="crtcn-space"></div>
    <div class="crtcn-cntr">
        <div class="crtcn-grid">
            <div class="crtcn-item">          
                <img class="crtcn-img" src="images/species/dungeness_crab.png">
                <div class="overlay-img">
                    <div class="overlay-content">
                        <div class="crtcn-name">Dungeness Crab</div>
                        <div class="crtcn-desc">An oval-shaped carapace that is yellow-brown to purplish. They have four pairs of walking legs and a pair of claws.</div>
                    </div>
                </div>
            </div>  
            <div class="crtcn-item">
                <img class="crtcn-img" src="images/species/fiddler_crab.jpg">
                <div class="overlay-img">
                    <div class="overlay-content">
                        <div class="crtcn-name">Fiddler Crab</div>
                        <div class="crtcn-desc">Are small, semi-terrestrial crabs are characterized by extreme cheliped asymmetry in males.</div>
                    </div>
                </div>
            </div>
            <div class="crtcn-item">
                <img class="crtcn-img" src="images/species/hermit_crab.jpg">
                <div class="overlay-img">
                    <div class="overlay-content">
                        <div class="crtcn-name">Hermit Crab</div>
                        <div class="crtcn-desc">A soft exoskeleton and a twisted abdomen to fit into snail shells.</div>
                    </div>
                </div>
            </div>
            <div class="crtcn-item">
                <img class="crtcn-img" src="images/species/king_crab.jpg">
                <div class="overlay-img">
                    <div class="overlay-content">
                        <div class="crtcn-name">King Crab</div>
                        <div class="crtcn-desc">They range in color from brownish to bluish red and are covered in sharp spines. They have three pairs of walking legs and one pair of claws.</div>
                    </div>
                </div>
            </div>
            <div class="crtcn-item">
                <img class="crtcn-img" src="images/species/rock_crab.jpg">
                <div class="overlay-img">
                    <div class="overlay-content">
                        <div class="crtcn-name">Rock Crab</div>
                        <div class="crtcn-desc">A wide carapace that is quite smooth to the touch and two large claws of equal size with black tips.</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <div class="footer">
        <div>
            <img class="footer-logo-img" src="images/cis_logo_name_footer.png">
        </div>
    </div>

    <!-- JS Links -->
    <script src="scripts/pop-out-image.js"></script>
</body>
</html>